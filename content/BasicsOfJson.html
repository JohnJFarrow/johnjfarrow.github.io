<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Using the Unreal Engine Json classes | unrealcode.net</title>
    <meta name="generator" content="VuePress 1.9.8">
    
    <meta name="description" content="Notes on using the Unreal Engine Json classes">
    
    <link rel="preload" href="/assets/css/0.styles.95d6faab.css" as="style"><link rel="preload" href="/assets/js/app.0c9de02a.js" as="script"><link rel="preload" href="/assets/js/3.5e27fb36.js" as="script"><link rel="preload" href="/assets/js/2.32bfe7ad.js" as="script"><link rel="preload" href="/assets/js/14.511875d3.js" as="script"><link rel="prefetch" href="/assets/js/10.49e97280.js"><link rel="prefetch" href="/assets/js/11.6e4ef963.js"><link rel="prefetch" href="/assets/js/12.0d1be04c.js"><link rel="prefetch" href="/assets/js/13.f0527924.js"><link rel="prefetch" href="/assets/js/15.0c124c5a.js"><link rel="prefetch" href="/assets/js/16.e41ee2d8.js"><link rel="prefetch" href="/assets/js/17.e886653d.js"><link rel="prefetch" href="/assets/js/18.4bb6e03a.js"><link rel="prefetch" href="/assets/js/19.cef54ddf.js"><link rel="prefetch" href="/assets/js/20.86f91cee.js"><link rel="prefetch" href="/assets/js/21.19e9b501.js"><link rel="prefetch" href="/assets/js/22.cc2d5517.js"><link rel="prefetch" href="/assets/js/23.5864e050.js"><link rel="prefetch" href="/assets/js/24.f5bbc596.js"><link rel="prefetch" href="/assets/js/25.0abcd3a3.js"><link rel="prefetch" href="/assets/js/26.c73388f6.js"><link rel="prefetch" href="/assets/js/27.e0d36fa0.js"><link rel="prefetch" href="/assets/js/28.047b3ff6.js"><link rel="prefetch" href="/assets/js/29.ccc7e84e.js"><link rel="prefetch" href="/assets/js/30.b110dc76.js"><link rel="prefetch" href="/assets/js/31.fdd102ce.js"><link rel="prefetch" href="/assets/js/32.02ea25e3.js"><link rel="prefetch" href="/assets/js/33.784e631a.js"><link rel="prefetch" href="/assets/js/34.2ad04cd5.js"><link rel="prefetch" href="/assets/js/35.e83e67d5.js"><link rel="prefetch" href="/assets/js/36.e4f8bb09.js"><link rel="prefetch" href="/assets/js/37.56fa83de.js"><link rel="prefetch" href="/assets/js/38.a3a76215.js"><link rel="prefetch" href="/assets/js/39.9be1ea14.js"><link rel="prefetch" href="/assets/js/4.b728e6f4.js"><link rel="prefetch" href="/assets/js/40.19e1d8f9.js"><link rel="prefetch" href="/assets/js/5.a48e27bc.js"><link rel="prefetch" href="/assets/js/6.9ff941c3.js"><link rel="prefetch" href="/assets/js/7.0e72a1a2.js"><link rel="prefetch" href="/assets/js/8.675e70c4.js"><link rel="prefetch" href="/assets/js/9.876839a1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.95d6faab.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">unrealcode.net</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Using the Unreal Engine Json classes</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/content/BasicsOfJson.html#necessary-includes" class="sidebar-link">Necessary Includes</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/content/BasicsOfJson.html#using-constant-field-names" class="sidebar-link">Using constant field names</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/content/BasicsOfJson.html#creating-json" class="sidebar-link">Creating Json</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/content/BasicsOfJson.html#writing-json-to-a-file" class="sidebar-link">Writing Json to a file</a></li></ul></li><li><a href="/content/BasicsOfJson.html#reading-json-from-a-file" class="sidebar-link">Reading Json from a file</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/content/BasicsOfJson.html#extracting-fields-from-the-reader" class="sidebar-link">Extracting fields from the reader</a></li><li class="sidebar-sub-header"><a href="/content/BasicsOfJson.html#reading-arrays-of-child-objects" class="sidebar-link">Reading arrays of child objects</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1>Using the Unreal Engine Json classes</h1> <p>Updated for Unreal Engine 5.0</p> <p>This document describes the basics of reading and writing Json with Unreal Engine classes.  The code here
reads and writes elements explicitly rather than reading and writing entire structs at one time.  This
is suitable for objects which are not using the UCLASS or UOBJECT macros to create reflection data.</p> <h2 id="necessary-includes"><a href="#necessary-includes" class="header-anchor">#</a> Necessary Includes</h2> <p>Include these header files:</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;Serialization/JsonTypes.h&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;Serialization/JsonWriter.h&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;Serialization/JsonSerializer.h&quot;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="using-constant-field-names"><a href="#using-constant-field-names" class="header-anchor">#</a> Using constant field names</h2> <p>To avoid spelling mistakes and make it easier to change Json field names, I suggest making the field names
constants like so:</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">namespace</span> JConstants
<span class="token punctuation">{</span>
	<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token keyword">const</span> <span class="token function">ArrayValue</span><span class="token punctuation">(</span><span class="token string">&quot;array-value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token keyword">const</span> <span class="token function">ArrayValueDisplayName</span><span class="token punctuation">(</span><span class="token string">&quot;array-value-display-name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token keyword">const</span> <span class="token function">ArrayValues</span><span class="token punctuation">(</span><span class="token string">&quot;array-values&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token keyword">const</span> <span class="token function">AvailableClasses</span><span class="token punctuation">(</span><span class="token string">&quot;available-classes&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token keyword">const</span> <span class="token function">ClassConfigName</span><span class="token punctuation">(</span><span class="token string">&quot;class-config-name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token keyword">const</span> <span class="token function">ClassName</span><span class="token punctuation">(</span><span class="token string">&quot;class-name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token keyword">const</span> <span class="token function">ClassDisplayName</span><span class="token punctuation">(</span><span class="token string">&quot;class-display-name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token keyword">const</span> <span class="token function">ConsoleVariable</span><span class="token punctuation">(</span><span class="token string">&quot;console-variable&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>It is a bit more work up front but it reduces errors.</p> <h2 id="creating-json"><a href="#creating-json" class="header-anchor">#</a> Creating Json</h2> <p>To create Json make a Json object which will contain everything:</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>TSharedRef<span class="token operator">&lt;</span> FJsonObject <span class="token operator">&gt;</span> JsonClassObject <span class="token operator">=</span> <span class="token generic-function"><span class="token function">MakeShared</span><span class="token generic class-name"><span class="token operator">&lt;</span>FJsonObject<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Then you can add fields to it using SetXXX methods like so:</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>JsonClassObject<span class="token operator">-&gt;</span><span class="token function">SetStringField</span><span class="token punctuation">(</span> JConstants<span class="token double-colon punctuation">::</span>ClassName<span class="token punctuation">,</span> ClassName<span class="token punctuation">)</span><span class="token punctuation">;</span>
JsonClassObject<span class="token operator">-&gt;</span><span class="token function">SetBoolField</span><span class="token punctuation">(</span> JConstants<span class="token double-colon punctuation">::</span>RestartRequired<span class="token punctuation">,</span> bRestartRequired<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>If you need to add a list of child objects, create an array object to hold this list:</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>TArray <span class="token operator">&lt;</span> TSharedPtr<span class="token operator">&lt;</span>FJsonValue<span class="token operator">&gt;</span> <span class="token operator">&gt;</span> JsonPropertyList<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Then create each child object and add it to the list object, then finally add the list object
to the containing object like so:</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>TSharedRef<span class="token operator">&lt;</span> FJsonObject <span class="token operator">&gt;</span> JsonOuterObject <span class="token operator">=</span> <span class="token generic-function"><span class="token function">MakeShared</span><span class="token generic class-name"><span class="token operator">&lt;</span>FJsonObject<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span><span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token comment">// make new child object</span>
	TSharedRef<span class="token operator">&lt;</span> FJsonObject <span class="token operator">&gt;</span> ChildObject <span class="token operator">=</span> <span class="token generic-function"><span class="token function">MakeShared</span><span class="token generic class-name"><span class="token operator">&lt;</span>FJsonObject<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// populate the child object</span>
	ChildObject<span class="token operator">-&gt;</span><span class="token function">SetStringField</span><span class="token punctuation">(</span> JConstants<span class="token double-colon punctuation">::</span>ClassConfigName<span class="token punctuation">,</span> ClassConfigName <span class="token punctuation">)</span><span class="token punctuation">;</span>
	ChildObject<span class="token operator">-&gt;</span><span class="token function">SetStringField</span><span class="token punctuation">(</span> JConstants<span class="token double-colon punctuation">::</span>ClassDisplayName<span class="token punctuation">,</span> ClassDisplayName <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// add the child object to the collection</span>
	JsonPropertyList<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token generic-function"><span class="token function">MakeShared</span><span class="token generic class-name"><span class="token operator">&lt;</span>FJsonValueObject<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>ChildObject<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// add the collection to the outer object which contains it</span>
JsonOuterObject<span class="token operator">-&gt;</span><span class="token function">SetArrayField</span><span class="token punctuation">(</span>JConstants<span class="token double-colon punctuation">::</span>Properties<span class="token punctuation">,</span> JsonPropertyList<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="writing-json-to-a-file"><a href="#writing-json-to-a-file" class="header-anchor">#</a> Writing Json to a file</h3> <p>First you need to write the Json object to a string, then serialize that string to file like this:</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>FString OutputString<span class="token punctuation">;</span>
TSharedRef<span class="token operator">&lt;</span>TJsonWriter<span class="token operator">&lt;</span><span class="token operator">&gt;&gt;</span> Writer <span class="token operator">=</span> <span class="token class-name">TJsonWriterFactory</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>OutputString<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">FJsonSerializer</span><span class="token double-colon punctuation">::</span><span class="token function">Serialize</span><span class="token punctuation">(</span>JsonOuter<span class="token punctuation">,</span> Writer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">FFileHelper</span><span class="token double-colon punctuation">::</span><span class="token function">SaveStringToFile</span><span class="token punctuation">(</span>OutputString<span class="token punctuation">,</span> <span class="token operator">*</span>AvailableClassesFileName <span class="token punctuation">)</span><span class="token punctuation">;</span>
Writer<span class="token operator">-&gt;</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="reading-json-from-a-file"><a href="#reading-json-from-a-file" class="header-anchor">#</a> Reading Json from a file</h2> <p>The entire Json is read from the file into a string, then that string is parsed using the
TJsonReader class, then each field and child object can be extracted.</p> <p>Reading from a file into string is like so:</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">const</span> FString FileName <span class="token operator">=</span> ResourceDirectory <span class="token operator">+</span> <span class="token string">&quot;\\Index.json&quot;</span><span class="token punctuation">;</span>
FString Contents<span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">FFileHelper</span><span class="token double-colon punctuation">::</span><span class="token function">LoadFileToString</span><span class="token punctuation">(</span>Contents<span class="token punctuation">,</span> <span class="token operator">*</span>FileName<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>Parsing the string into Json uses a TJsonReader and a static call on the FJsonSerializer class:</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>TSharedPtr<span class="token operator">&lt;</span>FJsonObject<span class="token operator">&gt;</span> FullJsonObject <span class="token operator">=</span> <span class="token generic-function"><span class="token function">MakeShared</span><span class="token generic class-name"><span class="token operator">&lt;</span>FJsonObject<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
TSharedRef<span class="token operator">&lt;</span>TJsonReader<span class="token operator">&lt;</span><span class="token operator">&gt;&gt;</span> Reader <span class="token operator">=</span> <span class="token class-name">TJsonReaderFactory</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span><span class="token function">Create</span><span class="token punctuation">(</span>Contents<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token class-name">FJsonSerializer</span><span class="token double-colon punctuation">::</span><span class="token function">Deserialize</span><span class="token punctuation">(</span>Reader<span class="token punctuation">,</span> FullJsonObject<span class="token punctuation">)</span> <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="extracting-fields-from-the-reader"><a href="#extracting-fields-from-the-reader" class="header-anchor">#</a> Extracting fields from the reader</h3> <p>The most basic approach is to test for the existence of a field and, if it exists, read it from the Json like so:</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>JsonObject<span class="token operator">-&gt;</span><span class="token generic-function"><span class="token function">HasTypedField</span><span class="token generic class-name"><span class="token operator">&lt;</span>EJson<span class="token double-colon punctuation">::</span>String<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>JConstants<span class="token double-colon punctuation">::</span>Title<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	JsonObject<span class="token operator">-&gt;</span><span class="token function">GetStringField</span><span class="token punctuation">(</span>PropertyName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>With some templates shown below this can be simplified to one call per field:</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>Description <span class="token operator">=</span> <span class="token generic-function"><span class="token function">GetIfExists</span><span class="token generic class-name"><span class="token operator">&lt;</span>FString<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>JsonObject<span class="token punctuation">,</span> JConstants<span class="token double-colon punctuation">::</span>Description <span class="token punctuation">)</span><span class="token punctuation">;</span>
Source <span class="token operator">=</span> <span class="token generic-function"><span class="token function">GetIfExists</span><span class="token generic class-name"><span class="token operator">&lt;</span>FString<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>JsonObject<span class="token punctuation">,</span> JConstants<span class="token double-colon punctuation">::</span>Source<span class="token punctuation">)</span><span class="token punctuation">;</span>
SourceURL <span class="token operator">=</span> <span class="token generic-function"><span class="token function">GetIfExists</span><span class="token generic class-name"><span class="token operator">&lt;</span>FString<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>JsonObject<span class="token punctuation">,</span> JConstants<span class="token double-colon punctuation">::</span>SourceURL <span class="token punctuation">)</span><span class="token punctuation">;</span>
Version <span class="token operator">=</span> <span class="token generic-function"><span class="token function">GetIfExists</span><span class="token generic class-name"><span class="token operator">&lt;</span>FString<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>JsonObject<span class="token punctuation">,</span> JConstants<span class="token double-colon punctuation">::</span>Version<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>The GetIfExists() function uses templates which are specialized for each data type (to save space only the FString and bool specializations are shown below).
First the <code>struct JsonEnum&lt;T&gt;</code> maps from a c++ data type such as FString to the corresponding EJson enumeration EJson::String.</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">template</span><span class="token operator">&lt;</span> <span class="token keyword">typename</span> <span class="token class-name">T</span> <span class="token operator">&gt;</span>
<span class="token keyword">struct</span> <span class="token class-name">JsonEnum</span><span class="token punctuation">;</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
<span class="token keyword">struct</span> <span class="token class-name">JsonEnum</span><span class="token operator">&lt;</span>FString<span class="token operator">&gt;</span>
<span class="token punctuation">{</span>
	<span class="token keyword">const</span> <span class="token keyword">static</span> EJson Type <span class="token operator">=</span> EJson<span class="token double-colon punctuation">::</span>String<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
<span class="token keyword">struct</span> <span class="token class-name">JsonEnum</span><span class="token operator">&lt;</span><span class="token keyword">bool</span><span class="token operator">&gt;</span>
<span class="token punctuation">{</span>
	<span class="token keyword">const</span> <span class="token keyword">static</span> EJson Type <span class="token operator">=</span> EJson<span class="token double-colon punctuation">::</span>Boolean<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>Then the <code>struct Extractor&lt;T&gt;</code> maps from a c++ data type such as FString to the corresponding GetXXX() call on the
FJsonObject like this:</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">template</span><span class="token operator">&lt;</span> <span class="token keyword">typename</span> <span class="token class-name">T</span> <span class="token operator">&gt;</span>
<span class="token keyword">struct</span> <span class="token class-name">Extractor</span><span class="token punctuation">;</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
<span class="token keyword">struct</span> <span class="token class-name">Extractor</span><span class="token operator">&lt;</span>FString<span class="token operator">&gt;</span>
<span class="token punctuation">{</span>
	FString <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">const</span> TSharedPtr<span class="token operator">&lt;</span>FJsonObject<span class="token operator">&gt;</span><span class="token operator">&amp;</span> JsonObject<span class="token punctuation">,</span> 
	                   <span class="token keyword">const</span> FString<span class="token operator">&amp;</span> PropertyName<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">return</span> JsonObject<span class="token operator">-&gt;</span><span class="token function">GetStringField</span><span class="token punctuation">(</span>PropertyName<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
<span class="token keyword">struct</span> <span class="token class-name">Extractor</span><span class="token operator">&lt;</span><span class="token keyword">bool</span><span class="token operator">&gt;</span>
<span class="token punctuation">{</span>
	<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">const</span> TSharedPtr<span class="token operator">&lt;</span>FJsonObject<span class="token operator">&gt;</span><span class="token operator">&amp;</span> JsonObject<span class="token punctuation">,</span> 
	                <span class="token keyword">const</span> FString<span class="token operator">&amp;</span> PropertyName<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">return</span> JsonObject<span class="token operator">-&gt;</span><span class="token function">GetBoolField</span><span class="token punctuation">(</span>PropertyName<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>And finally the <code>GetIfExists()</code> function uses the two above templates:</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">template</span><span class="token operator">&lt;</span> <span class="token keyword">typename</span> <span class="token class-name">T</span> <span class="token operator">&gt;</span>
T <span class="token function">GetIfExists</span><span class="token punctuation">(</span><span class="token keyword">const</span> TSharedPtr<span class="token operator">&lt;</span>FJsonObject<span class="token operator">&gt;</span><span class="token operator">&amp;</span> JsonObject<span class="token punctuation">,</span> 
			  <span class="token keyword">const</span> FString<span class="token operator">&amp;</span> PropertyName<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>JsonObject <span class="token operator">&amp;&amp;</span> JsonObject<span class="token operator">-&gt;</span><span class="token generic-function"><span class="token function">HasTypedField</span><span class="token generic class-name"><span class="token operator">&lt;</span> JsonEnum<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>Type <span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>PropertyName<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">return</span> Extractor<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">(</span>JsonObject<span class="token punctuation">,</span> PropertyName<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> <span class="token function">T</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="reading-arrays-of-child-objects"><a href="#reading-arrays-of-child-objects" class="header-anchor">#</a> Reading arrays of child objects</h3> <p>When the Json object has a child array of other objects, this can be accessed using the GetArrayField method:</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>JsonObject<span class="token operator">-&gt;</span><span class="token generic-function"><span class="token function">HasTypedField</span><span class="token generic class-name"><span class="token operator">&lt;</span>EJson<span class="token double-colon punctuation">::</span>Array<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>JConstants<span class="token double-colon punctuation">::</span>Settings<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">const</span> TArray<span class="token operator">&lt;</span>TSharedPtr<span class="token operator">&lt;</span>FJsonValue<span class="token operator">&gt;&gt;</span><span class="token operator">&amp;</span> Settings <span class="token operator">=</span> 
			JsonObject<span class="token operator">-&gt;</span><span class="token function">GetArrayField</span><span class="token punctuation">(</span>JConstants<span class="token double-colon punctuation">::</span>Settings<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">const</span> TSharedPtr<span class="token operator">&lt;</span>FJsonValue<span class="token operator">&gt;</span><span class="token operator">&amp;</span> Setting <span class="token operator">:</span> Settings<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">const</span> TSharedPtr<span class="token operator">&lt;</span>FJsonObject<span class="token operator">&gt;</span> Object <span class="token operator">=</span> Setting<span class="token operator">-&gt;</span><span class="token function">AsObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>Object<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			TSharedRef<span class="token operator">&lt;</span>FPresetSetting<span class="token operator">&gt;</span> PresetSetting <span class="token operator">=</span> <span class="token generic-function"><span class="token function">MakeShared</span><span class="token generic class-name"><span class="token operator">&lt;</span>FPresetSetting<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			PresetSetting<span class="token operator">-&gt;</span>ClassConfigName <span class="token operator">=</span> 
			               <span class="token generic-function"><span class="token function">GetIfExists</span><span class="token generic class-name"><span class="token operator">&lt;</span>FString<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span> Object<span class="token punctuation">,</span> JConstants<span class="token double-colon punctuation">::</span>ClassConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>
			PresetSetting<span class="token operator">-&gt;</span>ClassDisplayName <span class="token operator">=</span> 
			               <span class="token generic-function"><span class="token function">GetIfExists</span><span class="token generic class-name"><span class="token operator">&lt;</span>FString<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>Object<span class="token punctuation">,</span> JConstants<span class="token double-colon punctuation">::</span>ClassDisplay<span class="token punctuation">)</span><span class="token punctuation">;</span>
			PresetSetting<span class="token operator">-&gt;</span>PropertyDisplayName <span class="token operator">=</span> 
			               <span class="token generic-function"><span class="token function">GetIfExists</span><span class="token generic class-name"><span class="token operator">&lt;</span>FString<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>Object<span class="token punctuation">,</span> JConstants<span class="token double-colon punctuation">::</span>DisplayName<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main> <footer class="f"><div><p>MIT Licensed | Copyright Â© 2020-2023 John Farrow</p></div></footer></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.0c9de02a.js" defer></script><script src="/assets/js/3.5e27fb36.js" defer></script><script src="/assets/js/2.32bfe7ad.js" defer></script><script src="/assets/js/14.511875d3.js" defer></script>
  </body>
</html>
