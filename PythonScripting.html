<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Using Python to Create Unreal Engine Objects | unrealcode.net</title>
<meta name="description" content="Using Python to Create Unreal Engine Objects">
<meta charset="utf-8">
<link rel="stylesheet" type="text/css" href="./css/styles.css">
<link rel="stylesheet" type="text/css" href="./css/syntaxhighlightingstyles.css">
<link rel="stylesheet" type="text/css" href="./css/print.css" media="print">
</head>
<body>
<div id="app" data-server-rendered="true">
<div class="theme-container">
</div>
<header class="navbar">
<div class="sidebar-button">
</div>
<a href="index.html" aria-current="page" class="home-link router-link-exact-active router-link-active">
<span class="site-name">
unrealcode.net
</span>
</a>
<div class="links">
<nav class="nav-links can-hide">
<div class="nav-item">
<a href="index.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
Home
</a>
</div>
</nav>
</div>
</header>
<div class="sidebar-mask">
</div>
<aside class="sidebar">
<ul class="sidebar-links">
<li>
<section class="sidebar-group depth-0">
<p class="sidebar-heading open">
<span>
Using Python to Create Unreal Engine Objects
</span>
</p>
<ul class="sidebar-links sidebar-group-items">
<li>
<a class="sidebar-link" href="#introduction">
Introduction
</a>
</li>
<li>
<a class="sidebar-link" href="#basics">
Basics
</a>
<ul class="sidebar-sub-headers">
<li class="sidebar-sub-header">
<a class="sidebar-link" href="#example-file">
Example File
</a>
</li>
<li class="sidebar-sub-header">
<a class="sidebar-link" href="#entering-multiple-lines">
Entering multiple lines
</a>
</li>
<li class="sidebar-sub-header">
<a class="sidebar-link" href="#checking-it-works">
Checking it works 
</a>
</li>
</ul>
</li>
<li>
<a class="sidebar-link" href="#creating-a-new-level">
Creating a New Level
</a>
</li>
<li>
<a class="sidebar-link" href="#making-meshes-from-fbx-files">
Making Meshes from FBX files
</a>
</li>
<li>
<a class="sidebar-link" href="#making-a-blueprint">
Making a Blueprint 
</a>
<ul class="sidebar-sub-headers">
<li class="sidebar-sub-header">
<a class="sidebar-link" href="#making-components">
Making Components
</a>
</li>
<li class="sidebar-sub-header">
<a class="sidebar-link" href="#handles">
Handles
</a>
</li>
<li class="sidebar-sub-header">
<a class="sidebar-link" href="#creating-components">
Creating Components
</a>
</li>
<li class="sidebar-sub-header">
<a class="sidebar-link" href="#note-on-component-names">
Note on Component Names
</a>
</li>
<li class="sidebar-sub-header">
<a class="sidebar-link" href="#spawning-an-actor">
Spawning an Actor
</a>
</li>
<li class="sidebar-sub-header">
<a class="sidebar-link" href="#adding-lighting">
Adding Lighting
</a>
</li>
<li class="sidebar-sub-header">
<a class="sidebar-link" href="#finally">
Finally
</a>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</aside>
<main class="page">
<div class="theme-default-content content__default">
<h1>Using Python to Create Unreal Engine Objects</h1>
<p>Updated for Unreal Engine version 5.1</p>
<h2 id="introduction">Introduction</h2>
<p>The Unreal Editor ships with python 3.9.7 embedded in it.  You do not need to install any other distribution of python, although 
it could be useful if you are running an external editor like pycharm.</p>
<p>The Unreal Engine 5.1 python documentation is found at <a href="https://docs.unrealengine.com/5.1/en-US/PythonAPI/">https://docs.unrealengine.com/5.1/en-US/PythonAPI/</a></p>
<h2 id="basics">Basics</h2>
<p>To use python in Unreal Editor first make sure these plugins are enabled:</p>
<ul>
<li> &quot;Python Editor Script Plugin&quot;</li>
<li> &quot;Editor Scripting Utilities&quot;</li>
</ul>
<p>We will be editing python commands in a file external to Unreal and executing it from the command line at the bottom of the Output Log window:</p>
<p><img src="/images/python_001.png" alt="" /></p>
<p>To tell Unreal which directory your python files will be loaded from, use the <code>Edit | Project Settings...</code> menu option, then type &quot;python&quot; in the filter text box.  You should see a window like this one:</p>
<p><img src="/images/python_002.png" alt="" /></p>
<p>Click the &quot;+&quot; next to the Additional Paths and add the location of your files.  You may need to restart the editor after this.</p>
<h3 id="example-file">Example File</h3>
<p>To test the basic loading of python scripts do the following:</p>
<ul>
<li> make a directory called &quot;python&quot; underneath your projects content directory</li>
<li> add the python directory to the Additional Paths array as described above</li>
<li> download the file <a href="/make_world.py">make_world.py</a> and save it into your content/python directory.</li>
</ul>
<p>To load the make_world.py script in Unreal, use the command line at the bottom of the Output Log window as shown here:</p>
<p><img src="/images/python_003.png" alt="" /></p>
<p>Make sure the drop-down list on the left of the command line says &quot;Python&quot;, 
and enter this command:</p>
<div class="python"><pre>
<span class="keyword">import</span> make_world <span class="keyword">as</span> MW
</pre></div>
<p>In order to change the file externally and reload it, we need to run this command once:</p>
<div class="python"><pre>
<span class="keyword">from</span> importlib <span class="keyword">import</span> reload
</pre></div>
<p>and then each time we change the file we can type</p>
<div class="python"><pre>
reload(MW)
</pre></div>
<p>to reload it.</p>
<h3 id="entering-multiple-lines">Entering multiple lines</h3>
<p>To test multiple lines of code you can type them  in the command line by separating them with shift-enter, for example you can type</p>
<div class="python"><pre>
<span class="keyword">import</span> unreal
<span>print</span>(unreal<span class="number">.</span>LayersSubsystem().get_world())
</pre></div>
<p>as one command.  To repeatedly reload the python file from disk and execute it you can enter
this as one command (with shift-enter between the lines):</p>
<div class="python"><pre>
reload(MW)
MW<span class="number">.</span>run()
</pre></div>
<p>The example python file contains multiple functions, so you can call the ones you want using a multi-line scripts like so:</p>
<p><img src="/images/python_004.png" alt="" /></p>
<h3 id="checking-it-works">Checking it works </h3>
<p>At the top of the example python file are these lines:</p>
<div class="python"><pre>
<span class="keyword">import</span> unreal

<span class="keyword">def</span> check_loaded():
    <span>print</span>(<span class="string">&quot;make_world loaded ok&quot;</span>)
</pre></div>
<p>so to check everything is working we can type: (use shift-enter to insert a line break)</p>
<div class="python"><pre>
reload(MW)
MW<span class="number">.</span>check_loaded()
</pre></div>
<p>and we should see this in the Output Log:</p>
<p><img src="/images/python_003.png" alt="" /></p>
<h2 id="creating-a-new-level">Creating a New Level</h2>
<p>This is the code to create a new level, in a function which takes the level path.</p>
<div class="python"><pre>
<span class="keyword">def</span> new_level(name):
    ELL = unreal<span class="number">.</span>EditorLevelLibrary()
    ELL<span class="number">.</span>new_level(name)
</pre></div>
<p>It could be called from the Unreal command line like this:</p>
<div class="python"><pre>
MW<span class="number">.</span>new_level(<span class="string">&quot;/Game/Levels/NewLevel01&quot;</span>)
</pre></div>
<p>This will generate output similar to this in the Output Log window:</p>
<blockquote>
<p>Cmd: OBJ SAVEPACKAGE PACKAGE=&quot;/Game/Levels/NewLevel&quot; FILE=&quot;../../../../../../tmp/Content/Levels/NewLevel.umap&quot; SILENT=true AUTOSAVING=false KEEPDIRTY=false 
LogUObjectHash: Compacting FUObjectHashTables data took   0.32ms  <br />
LogSavePackage: Moving output files for package: /Game/Levels/NewLevel  <br />
LogSavePackage: Moving '../../../../../../tmp/MyProject9/Saved/NewLevelF447BBBC4C547A0F0EA7F39017B7A537.tmp' to '../../../../../../tmp/MyProject9/Content/Levels/NewLevel.umap'  <br />
LogFileHelpers: Saving map 'NewLevel' took 0.072  <br />
AssetCheck: New page: Asset Save: NewLevel  <br />
LogContentValidation: Display: Validating World /Game/Levels/NewLevel.NewLevel  </p>
</blockquote>
<p>If the level already exists it will generate an error like this:</p>
<blockquote>
<p>LevelEditorSubsystem: Error: NewLevel. Failed to validate the destination. An asset already exists at this location.  </p>
</blockquote>
<h2 id="making-meshes-from-fbx-files">Making Meshes from FBX files</h2>
<p>This is the code used to import a set of .fbx files into Static Mesh objects:</p>
<div class="python"><pre>
<span class="keyword">def</span> build_options() -&gt; unreal<span class="number">.</span>FbxImportUI:
    options = unreal<span class="number">.</span>FbxImportUI()
    options<span class="number">.</span>set_editor_property( name=<span class="string">&#39;import_mesh&#39;</span>, value=<span class="keyword">True</span>)
    options<span class="number">.</span>set_editor_property( name=<span class="string">&#39;import_textures&#39;</span>, value=<span class="keyword">False</span>)
    options<span class="number">.</span>set_editor_property( name=<span class="string">&#39;import_materials&#39;</span>, value=<span class="keyword">False</span>)
    options<span class="number">.</span>set_editor_property( name=<span class="string">&#39;import_as_skeletal&#39;</span>, value=<span class="keyword">False</span>)
    options<span class="number">.</span>static_mesh_import_data<span class="number">.</span>set_editor_property( name=<span class="string">&#39;import_uniform_scale&#39;</span>, value=<span class="number">1</span><span class="number">.</span><span class="number">0</span>)
    options<span class="number">.</span>static_mesh_import_data<span class="number">.</span>set_editor_property( name=<span class="string">&#39;combine_meshes&#39;</span>, value=<span class="keyword">True</span>)
    options<span class="number">.</span>static_mesh_import_data<span class="number">.</span>set_editor_property( name=<span class="string">&#39;auto_generate_collision&#39;</span>, value=<span class="keyword">True</span> )
    <span class="keyword">return</span> options


<span class="keyword">def</span> build_import_task(mesh_name: <span>str</span>,
                      filename: Path,
                      destination_path: <span>str</span>,
                      options: unreal<span class="number">.</span>FbxImportUI ) -&gt; unreal<span class="number">.</span>AssetImportTask:
    task = unreal<span class="number">.</span>AssetImportTask()
    task<span class="number">.</span>set_editor_property( name=<span class="string">&#39;automated&#39;</span>, value=<span class="keyword">True</span>)
    task<span class="number">.</span>set_editor_property( name=<span class="string">&#39;destination_name&#39;</span>, value=mesh_name)
    task<span class="number">.</span>set_editor_property( name=<span class="string">&#39;destination_path&#39;</span>, value=destination_path)
    task<span class="number">.</span>set_editor_property( name=<span class="string">&#39;filename&#39;</span>, value=<span>str</span>(filename) )
    task<span class="number">.</span>set_editor_property( name=<span class="string">&#39;replace_existing&#39;</span>, value=<span class="keyword">True</span>)
    task<span class="number">.</span>set_editor_property( name=<span class="string">&#39;replace_existing_settings&#39;</span>, value=<span class="keyword">True</span>)
    task<span class="number">.</span>set_editor_property( name=<span class="string">&#39;save&#39;</span>, value=<span class="keyword">True</span>)
    task<span class="number">.</span>set_editor_property( name=<span class="string">&#39;options&#39;</span>, value=options)
    <span class="keyword">return</span> task


<span class="keyword">def</span> import_static_meshes():
    mesh_data: <span>dict</span>[<span>str</span>, Path] = {
        <span class="string">&quot;SM_Arm&quot;</span>: Path(<span class="string">&quot;C:\\work\\TrebBlender\\Arm.0040_6.fbx&quot;</span>),
        <span class="string">&quot;SM_Ramp&quot;</span>: Path(<span class="string">&quot;C:\\work\\TrebBlender\\Ramp.fbx&quot;</span>),
        <span class="string">&quot;SM_Weight&quot;</span>: Path(<span class="string">&quot;C:\\work\\TrebBlender\\Weight.004_2.fbx&quot;</span>),
        <span class="string">&quot;SM_Base&quot;</span>: Path(<span class="string">&quot;C:\\work\\TrebBlender\\Base.004_3.fbx&quot;</span>)
    }

    options: unreal<span class="number">.</span>FbxImportUI = build_options()

    tasks: <span>list</span>[Unreal<span class="number">.</span>task] = [
        build_import_task(mesh_name=mesh_name, filename=path, destination_path=<span class="string">&quot;/Game/Meshes&quot;</span>, options=options) 
        <span class="keyword">for</span> mesh_name, path <span class="keyword">in</span> mesh_data<span class="number">.</span>items()]

    unreal<span class="number">.</span>AssetToolsHelpers<span class="number">.</span>get_asset_tools().import_asset_tasks(tasks)

    <span class="comment"># make the base use complex mesh for collision, so it does not collide with the weight</span>
    mesh: unreal<span class="number">.</span>StaticMesh = load_mesh(path=<span class="string">&quot;/Game/Meshes/SM_Base&quot;</span>)
    body_setup: unreal<span class="number">.</span>BodySetup = mesh<span class="number">.</span>get_editor_property(<span class="string">&quot;body_setup&quot;</span>)
    body_setup<span class="number">.</span>set_editor_property(name=<span class="string">&quot;collision_trace_flag&quot;</span>, 
                                   value=unreal<span class="number">.</span>CollisionTraceFlag<span class="number">.</span>CTF_USE_COMPLEX_AS_SIMPLE )

</pre></div>
<p>Basically what is does is create a <code>unreal.AssetImportTask()</code> for each fbx file
and then execute it to create a StaticMesh in the &quot;/Game/Meshes&quot; directory.</p>
<p>We treat the SM_Base mesh differently.  We want to set the &quot;Collision Complexity&quot;
property to &quot;Use Complex Collision as Simple&quot;. This involves getting the &quot;body_setup&quot;
property from the mesh and updating it.  It is not necessary to set the &quot;body_setup&quot;
property back on the mesh - we have reference to the body_setup property rather than a copy of it.</p>
<div class="python"><pre>
mesh: unreal<span class="number">.</span>StaticMesh = load_mesh(path=<span class="string">&quot;/Game/Meshes/SM_Base&quot;</span>)
body_setup: unreal<span class="number">.</span>BodySetup = mesh<span class="number">.</span>get_editor_property(<span class="string">&quot;body_setup&quot;</span>)
body_setup<span class="number">.</span>set_editor_property(name=<span class="string">&quot;collision_trace_flag&quot;</span>, 
                               value=unreal<span class="number">.</span>CollisionTraceFlag<span class="number">.</span>CTF_USE_COMPLEX_AS_SIMPLE )
</pre></div><h2 id="making-a-blueprint">Making a Blueprint </h2>
<p>This section shows how to make a new blueprint class, how to add components to it, and to set the properties on those components.</p>
<p>The code for making a blueprint is:</p>
<div class="python"><pre>
<span class="keyword">def</span> make_blueprint(package_path: <span>str</span>, asset_name: <span>str</span>):

    factory = unreal<span class="number">.</span>BlueprintFactory()
    factory<span class="number">.</span>set_editor_property(name=<span class="string">&quot;parent_class&quot;</span>, value=unreal<span class="number">.</span>Actor)

    asset_tools: unreal<span class="number">.</span>AssetTools = unreal<span class="number">.</span>AssetToolsHelpers<span class="number">.</span>get_asset_tools()

    asset: <span>Object</span> = asset_tools<span class="number">.</span>create_asset(asset_name=asset_name, 
                                             package_path=package_path, 
                                             asset_class=<span class="keyword">None</span>, 
                                             factory=factory)
    <span class="keyword">if</span> <span class="keyword">not</span> <span>isinstance</span>(asset, unreal<span class="number">.</span>Blueprint):
        <span class="keyword">raise</span> Exception(<span class="string">&quot;Failed to create blueprint asset&quot;</span>)
    blueprint: unreal<span class="number">.</span>Blueprint = asset <span class="comment"># noqa</span>
</pre></div>
<p>This is called by passing in the location where the blueprint will be created
and its name, like so:</p>
<div class="python"><pre>
package_path = <span class="string">&quot;/Game/Blueprints&quot;</span>
asset_name = <span class="string">&quot;BP_Trebuchet20&quot;</span>
MW<span class="number">.</span>make_blueprint( package_path, asset_name )
</pre></div><h3 id="making-components">Making Components</h3>
<p>In the Unreal forums there is a snippet showing <a href="https://dev.epicgames.com/community/snippets/dV5/add-a-component-with-blueprint-script-in-the-editor">how to add components to 
a blueprint using blueprint script</a>.  The code below
follows a similar approach except it uses python instead of blueprints.</p>
<p>First we get the subsystem which is used to create components (aka subobjects):</p>
<div class="python"><pre>
subsystem: unreal<span class="number">.</span>SubobjectDataSubsystem 
     = unreal<span class="number">.</span>get_engine_subsystem(unreal<span class="number">.</span>SubobjectDataSubsystem)
</pre></div><h4 id="handles">Handles</h4>
<p>The Unreal python API distinguishes between an object and a handle.   </p>
<p>Conceptually, a python variable 
(for example of type <code>unreal.Object</code>) holds a direct reference to an object.</p>
<p>A handle (of type <code>unreal.SubobjectDataHandle</code>) holds a unique identifier for an object, not the object itself. We need to bear in mind that we can
have a handle which is invalid.  It might refer to an object which no longer exists, for example it was deleted after we obtained the handle, or perhaps the handle
was created without associating an object with it.</p>
<p>We have put the code for creating a component in a separate function:</p>
<div class="python"><pre>
<span class="keyword">def</span> add_subobject(subsystem: unreal<span class="number">.</span>SubobjectDataSubsystem,
                  blueprint: unreal<span class="number">.</span>Blueprint,
                  new_class,
                  name: <span>str</span> ) -&gt; ( unreal<span class="number">.</span>SubobjectDataHandle, unreal<span class="number">.</span><span>Object</span> ):

    root_data_handle: unreal<span class="number">.</span>SubobjectDataHandle = 
         subsystem<span class="number">.</span>k2_gather_subobject_data_for_blueprint(context=blueprint)[<span class="number">0</span>]

    sub_handle, fail_reason = subsystem<span class="number">.</span>add_new_subobject(
        params=unreal<span class="number">.</span>AddNewSubobjectParams(
            parent_handle=root_data_handle,
            new_class=new_class,
            blueprint_context=blueprint))
    
    <span class="keyword">if</span> <span class="keyword">not</span> fail_reason<span class="number">.</span>is_empty():
        <span class="keyword">raise</span> Exception(<span class="string">&quot;ERROR from sub_object_subsystem.add_new_subobject: {fail_reason}&quot;</span>)

    subsystem<span class="number">.</span>rename_subobject(handle=sub_handle, new_name=unreal<span class="number">.</span>Text(name))
    subsystem<span class="number">.</span>attach_subobject(owner_handle=root_data_handle, child_to_add_handle=sub_handle)

    BFL = unreal<span class="number">.</span>SubobjectDataBlueprintFunctionLibrary
    obj: <span>Object</span> = BFL<span class="number">.</span>get_object(BFL<span class="number">.</span>get_data(sub_handle))
    <span class="keyword">return</span> sub_handle, obj
</pre></div>
<p>We pass this function:</p>
<ul>
<li> the subsystem which is used to create components</li>
<li> the blueprint we want the component added to</li>
<li> the class of the component we want created, such as <code>unreal.StaticMeshComponent</code></li>
<li> the name of the new component</li>
</ul>
<p>The function returns both the handle to the object and the new object itself.</p>
<p>The function calls <code>subsystem.add_new_subobject()</code> to create the component,
and then we use these lines to get the object from the handle:</p>
<div class="python"><pre>
BFL = unreal<span class="number">.</span>SubobjectDataBlueprintFunctionLibrary
obj = BFL<span class="number">.</span>get_object(BFL<span class="number">.</span>get_data(sub_handle))
</pre></div>
<p>We return both the handle and the object because we need the handle
to position the new component as a child of other components, and 
we need to object to set properties on it.</p>
<h4 id="creating-components">Creating Components</h4>
<p>The code for creating different types of subcomponents and setting their properties is below.</p>
<p>For a Static Mesh Component we do this:</p>
<div class="python"><pre>
sub_handle, weight = add_subobject(subsystem=subsystem, 
                                   blueprint=blueprint, 
                                   new_class=unreal<span class="number">.</span>StaticMeshComponent, 
                                   name=<span class="string">&quot;Weight&quot;</span>)
<span class="keyword">assert</span> <span>isinstance</span>(weight, unreal<span class="number">.</span>StaticMeshComponent)
mesh: unreal<span class="number">.</span>StaticMesh = load_mesh(path=<span class="string">&quot;/Game/Meshes/SM_Weight&quot;</span>)
weight<span class="number">.</span>set_static_mesh(new_mesh=mesh)
weight<span class="number">.</span>set_editor_property(name=<span class="string">&quot;mobility&quot;</span>, value=unreal<span class="number">.</span>ComponentMobility<span class="number">.</span>MOVABLE)
weight<span class="number">.</span>set_editor_property(name=<span class="string">&quot;relative_location&quot;</span>, value=unreal<span class="number">.</span>Vector(<span class="number">10</span><span class="number">.</span><span class="number">0</span>, -<span class="number">165</span><span class="number">.</span><span class="number">0</span>, <span class="number">640</span><span class="number">.</span><span class="number">0</span>))
weight<span class="number">.</span>set_simulate_physics(simulate=<span class="keyword">True</span>)
weight<span class="number">.</span>set_enable_gravity(gravity_enabled=<span class="keyword">True</span>)
weight<span class="number">.</span>set_mass_override_in_kg(unreal<span class="number">.</span>Name(<span class="string">&quot;NAME_None&quot;</span>), <span class="number">4506</span>)
weight<span class="number">.</span>set_collision_profile_name(collision_profile_name=PhysicsActor)
subsystem<span class="number">.</span>attach_subobject( base_handle, sub_handle )
</pre></div>
<p>For a Physics Constraint Component we do this:</p>
<div class="python"><pre>
<span class="comment"># ArmBaseConstraint</span>
sub_handle, arm_base = add_subobject(subsystem=subsystem, 
                                     blueprint=blueprint, 
                                     new_class=unreal<span class="number">.</span>PhysicsConstraintComponent, 
                                     name=<span class="string">&quot;ArmBaseConstraint&quot;</span>)
<span class="keyword">assert</span> <span>isinstance</span>(arm_base, unreal<span class="number">.</span>PhysicsConstraintComponent)
arm_base<span class="number">.</span>set_editor_property(name=<span class="string">&quot;relative_location&quot;</span>, 
    value=unreal<span class="number">.</span>Vector(<span class="number">10</span><span class="number">.</span><span class="number">000000</span>, <span class="number">0</span><span class="number">.</span><span class="number">000000</span>, <span class="number">740</span><span class="number">.</span><span class="number">000000</span>))
arm_base<span class="number">.</span>set_editor_property(name=<span class="string">&quot;component_name1&quot;</span>, value=ccBase)
arm_base<span class="number">.</span>set_editor_property(name=<span class="string">&quot;component_name2&quot;</span>, value=ccArm)
arm_base<span class="number">.</span>set_linear_x_limit(unreal<span class="number">.</span>LinearConstraintMotion<span class="number">.</span>LCM_LOCKED, <span class="number">0</span>)
arm_base<span class="number">.</span>set_linear_y_limit(unreal<span class="number">.</span>LinearConstraintMotion<span class="number">.</span>LCM_LOCKED, <span class="number">0</span>)
arm_base<span class="number">.</span>set_linear_z_limit(unreal<span class="number">.</span>LinearConstraintMotion<span class="number">.</span>LCM_LOCKED, <span class="number">0</span>)
arm_base<span class="number">.</span>set_angular_swing1_limit(unreal<span class="number">.</span>AngularConstraintMotion<span class="number">.</span>ACM_LOCKED, <span class="number">0</span>)
arm_base<span class="number">.</span>set_angular_swing2_limit(unreal<span class="number">.</span>AngularConstraintMotion<span class="number">.</span>ACM_LOCKED, <span class="number">0</span>)
arm_base<span class="number">.</span>set_angular_twist_limit(unreal<span class="number">.</span>AngularConstraintMotion<span class="number">.</span>ACM_FREE, <span class="number">0</span>)
arm_base<span class="number">.</span>set_disable_collision(<span class="keyword">True</span>)
subsystem<span class="number">.</span>attach_subobject( base_handle, sub_handle )
</pre></div><h4 id="note-on-component-names">Note on Component Names</h4>
<p>Physics Constraint Components need to know the names of the components
they are connected to.</p>
<p>In c++ this is done by calling SetConstrainedComponents() and passing in 
the two components like this:</p>
<div class="cplusplus"><pre>
Base = CreateDefaultSubobject&lt;UStaticMeshComponent&gt;(TEXT(<span class="string">&quot;Base&quot;</span>));
Arm = CreateDefaultSubobject&lt;UStaticMeshComponent&gt;(TEXT(<span class="string">&quot;Arm&quot;</span>));
ArmBaseConstraint = 
   CreateDefaultSubobject&lt; UPhysicsConstraintComponent &gt;(TEXT(<span class="string">&quot;ArmBaseConstraint&quot;</span>));
ArmBaseConstraint-&gt;SetConstrainedComponents( Base, TEXT(<span class="string">&quot;&quot;</span>), Arm, TEXT(<span class="string">&quot;&quot;</span>) );
</pre></div>
<p>From the  <a href="https://docs.unrealengine.com/5.0/en-US/PythonAPI/class/PhysicsConstraintComponent.html">python documentation</a>
it looks as though the same approach would work, namely:</p>
<div class="python"><pre>
sub_handle, base = add_subobject(subsystem=subsystem, 
                                   blueprint=blueprint, 
                                   new_class=unreal<span class="number">.</span>StaticMeshComponent, 
                                   name=<span class="string">&quot;Base&quot;</span>)
sub_handle, arm = add_subobject(subsystem=subsystem, 
                                   blueprint=blueprint, 
                                   new_class=unreal<span class="number">.</span>StaticMeshComponent, 
                                   name=<span class="string">&quot;Arm&quot;</span>)
sub_handle, constraint = add_subobject(subsystem=subsystem, 
                                     blueprint=blueprint, 
                                     new_class=unreal<span class="number">.</span>PhysicsConstraintComponent, 
                                     name=<span class="string">&quot;ArmBaseConstraint&quot;</span>)
constraint<span class="number">.</span>set_constrained_components( base, <span class="string">&quot;&quot;</span>, arm, <span class="string">&quot;&quot;</span> )
</pre></div>
<p>But this does not work.  If we use the c++ code, the constraint ends up 
referencing a component named &quot;Base&quot;, which is what we want, but using the python
code it ends up a component name of &quot;Base_GEN_VARIABLE&quot; for some reason.</p>
<p>So we have to use the <code>set_editor_property()</code> call to specify each constrained component name
and that takes an object of type <code>unreal.ConstrainComponentPropName</code>, so we have to 
make those objects like so:</p>
<div class="python"><pre>
<span class="keyword">def</span> make_component_name(name: <span>str</span>) -&gt; unreal<span class="number">.</span>ConstrainComponentPropName:
    cc = unreal<span class="number">.</span>ConstrainComponentPropName()
    cc<span class="number">.</span>set_editor_property(name=<span class="string">&quot;component_name&quot;</span>, value=name)
    <span class="keyword">return</span> cc

ccBase = make_component_name(name=<span class="string">&quot;Base&quot;</span>)
ccArm = make_component_name(name=<span class="string">&quot;Arm&quot;</span>)

constraint<span class="number">.</span>set_editor_property(name=<span class="string">&quot;component_name1&quot;</span>, value=ccBase)
constraint<span class="number">.</span>set_editor_property(name=<span class="string">&quot;component_name2&quot;</span>, value=ccArm)
</pre></div><h3 id="spawning-an-actor">Spawning an Actor</h3>
<p>To create an instance of the new blueprint in the world we do this:</p>
<div class="python"><pre>
<span class="keyword">def</span> spawn(package_path: <span>str</span>, asset_name: <span>str</span>):
    <span class="comment"># spawn actor on map</span>
    EAL = unreal<span class="number">.</span>EditorAssetLibrary
    ELL = unreal<span class="number">.</span>EditorLevelLibrary
    blueprint_class = EAL<span class="number">.</span>load_blueprint_class( asset_path=package_path + <span class="string">&quot;/&quot;</span> + asset_name )
    <span class="keyword">assert</span> <span>isinstance</span>(blueprint_class, unreal<span class="number">.</span>BlueprintGeneratedClass )
    location = unreal<span class="number">.</span>Vector(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)
    rotation = (location - location).rotator()
    ELL<span class="number">.</span>spawn_actor_from_class(actor_class=blueprint_class, location=location, rotation=rotation)
</pre></div>
<p>To spawn a PlayerStart object we do this:</p>
<div class="python"><pre>
<span class="keyword">def</span> spawn_player_start():
    <span class="comment"># spawn actor on map</span>
    ELL = unreal<span class="number">.</span>EditorLevelLibrary
    location = unreal<span class="number">.</span>Vector(<span class="number">2000</span>, <span class="number">0</span>, <span class="number">500</span>)
    rotation = unreal<span class="number">.</span>Rotator(<span class="number">0</span>, <span class="number">0</span>, <span class="number">180</span>)
    ELL<span class="number">.</span>spawn_actor_from_class( actor_class=unreal<span class="number">.</span>PlayerStart, 
        location=location, rotation=rotation)
</pre></div><h3 id="adding-lighting">Adding Lighting</h3>
<p>This code constructs some lighting objects so we can see the scene and check it works:</p>
<div class="python"><pre>
<span class="keyword">def</span> create_lights():
    ELL = unreal<span class="number">.</span>EditorLevelLibrary
    location = unreal<span class="number">.</span>Vector(<span class="number">2000</span>, <span class="number">0</span>, <span class="number">500</span>)
    rotation = unreal<span class="number">.</span>Rotator(<span class="number">0</span>, <span class="number">0</span>, <span class="number">180</span>)

    skylight: unreal<span class="number">.</span>Actor = ELL<span class="number">.</span>spawn_actor_from_class( actor_class=unreal<span class="number">.</span>SkyLight, location=location, rotation=rotation)
    atmos_light: unreal<span class="number">.</span>Actor = ELL<span class="number">.</span>spawn_actor_from_class( actor_class=unreal<span class="number">.</span>DirectionalLight, location=location, rotation=rotation)
    atmos: unreal<span class="number">.</span>Actor = ELL<span class="number">.</span>spawn_actor_from_class( actor_class=unreal<span class="number">.</span>SkyAtmosphere, location=location, rotation=rotation)
    cloud: unreal<span class="number">.</span>Actor = ELL<span class="number">.</span>spawn_actor_from_class( actor_class=unreal<span class="number">.</span>VolumetricCloud, location=location, rotation=rotation)
    fog: unreal<span class="number">.</span>Actor = ELL<span class="number">.</span>spawn_actor_from_class( actor_class=unreal<span class="number">.</span>ExponentialHeightFog, location=location, rotation=rotation)

    <span class="keyword">if</span> <span>isinstance</span>(atmos_light, unreal<span class="number">.</span>DirectionalLight):
        dlc: unreal<span class="number">.</span>DirectionalLightComponent = atmos_light<span class="number">.</span>get_editor_property(<span class="string">&quot;directional_light_component&quot;</span>)
        dlc<span class="number">.</span>set_intensity(new_intensity=<span class="number">400</span>)
</pre></div><h3 id="finally">Finally</h3>
<p>The python script we have been looking at is divided up in functions both to simplify it and so 
the functions can be called separately while testing.  The script also contains a 
single function show below which creates the map, imports the meshes, creates
a new blueprint and sets up the scene so all we have to do is press play:</p>
<div class="python"><pre>
<span class="keyword">def</span> create_everything():
    level_name = <span class="string">&quot;/Game/Levels/NewLevel24&quot;</span>
    package_path = <span class="string">&quot;/Game/Blueprints&quot;</span>
    asset_name = <span class="string">&quot;BP_Trebuchet24&quot;</span>

    new_level(name=level_name)
    set_current_level(name=level_name)
    import_static_meshes()
    make_blueprint( package_path=package_path, asset_name=asset_name )
    spawn( package_path=package_path, asset_name=asset_name )
    spawn_player_start()
    create_lights()
</pre></div>
<p>If we run this script like so:</p>
<p><img src="/images/python_012.png" alt="" /></p>
<p>The we can see the new level with the trebuchet actor and the lighting:</p>
<p><img src="/images/python_013.png" alt="" /></p>
<p>And if we press play we can see the blueprint working:</p>
<p><img src="/images/python_014.gif" alt="" /></p>

</div>
<footer class="no-sidebar">
<div>
<p class="page-footer">
MIT Licensed | Copyright © 2020-2024 John Farrow
: john.farrow@unrealcode.net
</p>
</div>
</footer>
</main>
</div>
</body>
</html>
