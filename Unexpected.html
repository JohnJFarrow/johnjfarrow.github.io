
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="index, follow" />

  <script type="text/javascript">
  function putEmail() {
    var domain = 'unrealcode.net';
    var user = 'john.farrow';
    element = document.getElementById('email');
    element.innerHTML = user + '@' + domain;
  }
  </script>


    <link rel="stylesheet" type="text/css" href="/theme/stylesheet/style.min.css">

    <link id="dark-theme-style" rel="stylesheet" type="text/css"
          media="(prefers-color-scheme: dark), (prefers-color-scheme: no-preference)"
    href="/theme/stylesheet/dark-theme.min.css">

    <link id="pygments-dark-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: dark), (prefers-color-scheme: no-preference)"
          href="/theme/pygments/monokai.min.css">
    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: light)"
          href="/theme/pygments/emacs.min.css">



  <link rel="stylesheet" type="text/css" href="/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="/theme/font-awesome/css/solid.css">

  <link rel="stylesheet" type="text/css" href="/custom.css">




  


 

<meta name="author" content="John Farrow" />
<meta name="description" content="Unexpected Unreal Behaviour" />
<meta name="keywords" content="unreal engine, c++">


  <meta property="og:site_name" content="Unreal Code"/>
  <meta property="og:title" content="Unexpected Unreal Behaviour"/>
  <meta property="og:description" content="Unexpected Unreal Behaviour"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="/Unexpected.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2022-09-23 00:00:00+12:00"/>
  <meta property="article:modified_time" content=""/>
  <meta property="article:author" content="/author/john-farrow.html">
  <meta property="article:section" content="unreal"/>
  <meta property="article:tag" content="unreal engine"/>
  <meta property="article:tag" content="c++"/>
  <meta property="og:image" content="">

  <title>Unreal Code &ndash; Unexpected Unreal Behaviour</title>

</head>
<body onload="putEmail();" >
  <aside>
    <div>
      <a href="/">
        <img src="/theme/img/profile.png" alt="Experiments with Unreal Engine" title="Experiments with Unreal Engine">
      </a>

      <h1>
        <a href="/">Experiments with Unreal Engine</a>
      </h1>

<p>John Farrow</p>
      <p id="email">EMAIL</p>
       <ul class="social">
          <li>
            <a  class="sc-github" href="https://github.com/johnjfarrow/" target="_blank">
              <i class="fab fa-github"></i>
            </a>
          </li>
          <li>
            <a  class="sc-linkedin" href="https://www.linkedin.com/in/johnjfarrow" target="_blank">
              <i class="fab fa-linkedin"></i>
            </a>
          </li>
      </ul>
    </div>

  </aside>
  <main>

    <nav>
      <a href="/">Home</a>



    </nav>

<article class="single">
  <header>
      
    <h1 id="Unexpected">Unexpected Unreal&nbsp;Behaviour</h1>
    <p>
      Posted on September 23, 2022 in <a href="/category/unreal.html">unreal</a>

    </p>
  </header>


  <div>
    <h2>Introduction</h2>
<p>This is notes on Unreal Engine behaviour which might&nbsp;surprise.</p>
<h3>The Unreal Header Tool sometimes changes method parameter&nbsp;declarations</h3>
<p>Given a class declared like&nbsp;this:</p>
<div class="highlight"><pre><span></span><code><span class="n">USTRUCT</span><span class="p">(</span><span class="n">BlueprintType</span><span class="p">)</span><span class="w"></span>
<span class="k">struct</span><span class="w"> </span><span class="nc">EXAMPLE_API</span><span class="w"> </span><span class="n">FActionContainer</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">GENERATED_BODY</span><span class="p">()</span><span class="w"></span>

<span class="p">};</span><span class="w"></span>

<span class="n">UCLASS</span><span class="p">()</span><span class="w"></span>
<span class="k">class</span><span class="w"> </span><span class="nc">EXAMPLE_API</span><span class="w"> </span><span class="n">AMyCharacter</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">ACharacter</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">GENERATED_BODY</span><span class="p">()</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Sets default values for this character&#39;s properties</span>
<span class="w">    </span><span class="n">AMyCharacter</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="n">UFUNCTION</span><span class="p">(</span><span class="n">BlueprintImplementableEvent</span><span class="p">,</span><span class="w"> </span><span class="n">Category</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Interaction&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">OpenExpandableItemActions</span><span class="p">(</span><span class="n">TArray</span><span class="o">&lt;</span><span class="n">FActionContainer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">actions</span><span class="p">);</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
</code></pre></div>

<p>The above code will not compile.  In the output window we get this&nbsp;error:</p>
<div class="highlight"><pre><span></span><code><span class="mi">1</span><span class="o">&gt;</span><span class="n">MyCharacter</span><span class="o">.</span><span class="n">gen</span><span class="o">.</span><span class="n">cpp</span><span class="p">(</span><span class="mi">71</span><span class="p">):</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">C2511</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="s1">&#39;void AMyCharacter::OpenExpandableItemActions(const TArray&lt;FActionContainer,FDefaultAllocator&gt; &amp;)&#39;</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="n">overloaded</span><span class="w"> </span><span class="n">member</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="s1">&#39;AMyCharacter&#39;</span><span class="w"></span>
<span class="mi">1</span><span class="o">&gt;</span><span class="n">MyCharacter</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">19</span><span class="p">):</span><span class="w"> </span>
<span class="w">    </span><span class="n">note</span><span class="p">:</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">declaration</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="s1">&#39;AMyCharacter&#39;</span><span class="w"></span>
<span class="mi">1</span><span class="o">&gt;</span><span class="n">MyCharacter</span><span class="o">.</span><span class="n">gen</span><span class="o">.</span><span class="n">cpp</span><span class="p">(</span><span class="mi">75</span><span class="p">):</span><span class="w"> </span>
<span class="w">    </span><span class="n">error</span><span class="w"> </span><span class="n">C2352</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;UObject::FindFunctionChecked&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="k">static</span><span class="w"> </span><span class="n">member</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">requires</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">object</span><span class="w"></span>
<span class="mi">1</span><span class="o">&gt;</span><span class="nb nb-Type">Object</span><span class="o">.</span><span class="n">h</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="n">see</span><span class="w"> </span><span class="n">declaration</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="s1">&#39;UObject::FindFunctionChecked&#39;</span><span class="w"></span>
</code></pre></div>

<p>What is happening here is that the Unreal Header Tool (<span class="caps">UHT</span>)
is generating code into the file MyCharacter.gen.cpp, and the code it is
generating has different parameter types than the code 
in our class declaration.  The code in the generated .cpp file looks like&nbsp;this:</p>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="n">FName</span><span class="w"> </span><span class="n">NAME_AMyCharacter_OpenExpandableItemActions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FName</span><span class="p">(</span><span class="n">TEXT</span><span class="p">(</span><span class="s">&quot;OpenExpandableItemActions&quot;</span><span class="p">));</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="nf">AMyCharacter::OpenExpandableItemActions</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">TArray</span><span class="o">&lt;</span><span class="n">FActionContainer</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">actions</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">MyCharacter_eventOpenExpandableItemActions_Parms</span><span class="w"> </span><span class="n">Parms</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Parms</span><span class="p">.</span><span class="n">actions</span><span class="o">=</span><span class="n">actions</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">ProcessEvent</span><span class="p">(</span><span class="n">FindFunctionChecked</span><span class="p">(</span><span class="n">NAME_AMyCharacter_OpenExpandableItemActions</span><span class="p">),</span><span class="o">&amp;</span><span class="n">Parms</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p>This code is generated to support the <code>BlueprintImplementableEvent</code> aspect of the
<code>OpenExpandableItemActions</code> method, so that the method can be implemented
in a blueprint rather than in&nbsp;c++.</p>
<p>The <span class="caps">UHT</span> generates code which uses the types which blueprint supports, which in this
example are different from the types we used when declaring <code>OpenExpandableItemActions</code>.
Specifically <span class="caps">UHT</span> changes the type of the <code>actions</code> parameter 
from <code>TArray&lt;FActionContainer&gt;</code> to <code>const TArray&lt;FActionContainer&gt;&amp;</code>, i.e.
it changes a value type to a const reference&nbsp;type.</p>
<p>The solution to this error is to change our header to define the method
the way <span class="caps">UHT</span> wants, i.e. using a const reference like&nbsp;this:</p>
<div class="highlight"><pre><span></span><code><span class="n">UCLASS</span><span class="p">()</span><span class="w"></span>
<span class="k">class</span><span class="w"> </span><span class="nc">GARBAGECOLLECTION_API</span><span class="w"> </span><span class="n">AMyCharacter</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">ACharacter</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">GENERATED_BODY</span><span class="p">()</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Sets default values for this character&#39;s properties</span>
<span class="w">    </span><span class="n">AMyCharacter</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="n">UFUNCTION</span><span class="p">(</span><span class="n">BlueprintImplementableEvent</span><span class="p">,</span><span class="w"> </span><span class="n">Category</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Interaction&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">OpenExpandableItemActions</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">TArray</span><span class="o">&lt;</span><span class="n">FActionContainer</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">actions</span><span class="p">);</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
</code></pre></div>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="/tag/unreal-engine.html">unreal engine</a>
      <a href="/tag/c.html">c++</a>
    </p>
  </div>






</article>

    <footer>
<p>
  &copy; 2022  - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses//4.0/deed.en_US" target="_blank">Creative Commons Attribution-ShareAlike</a>
</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
  <span class="footer-separator">|</span>
  Switch to the <a href="javascript:void(0)" onclick="theme.switch(`dark`)">dark</a> | <a href="javascript:void(0)" onclick="theme.switch(`light`)">light</a> | <a href="javascript:void(0)" onclick="theme.switch(`browser`)">browser</a> theme
  <script id="dark-theme-script"
          src="/theme/dark-theme/dark-theme.min.js"
          data-enable-auto-detect-theme="True"
          data-default-theme="dark"
          type="text/javascript">
  </script>
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses//4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
           src="https://i.creativecommons.org/l//4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Unreal Code ",
  "url" : "",
  "image": "",
  "description": ""
}
</script>

  
</body>
</html>