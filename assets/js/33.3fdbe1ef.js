(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{317:function(t,a,e){"use strict";e.r(a);var n=e(14),s=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",[t._v(t._s(this.$page.title))]),t._v(" "),a("h2",{attrs:{id:"introduction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#introduction"}},[t._v("#")]),t._v(" Introduction")]),t._v(" "),a("p",[t._v("This is an attempt to understand the Unreal Game Features Subsystem.  The Game Features Subsystem is used\nin the Valley of the Ancient and Lyra examples, and in Fortnite, to distribute game assets and functions as plugins.")]),t._v(" "),a("p",[t._v("Plugins can contained both code and assets. Once support for the Game Features Subsystem is in place a particular game mode or map (or anything really) can be developed and distributed as a\nplugin and added to a game without modifying the base game.  This has a lot of benefits including flexibility in\ndevelopment and better management of which assets are in memory when.  The Lyra example uses this approach to\ndeliver different game modes (such as deathmatch) as different plugins.")]),t._v(" "),a("p",[t._v("The  Game Features Subsystem makes elements in the base game responsive to plugins being enabled and disabled.  For example\nwhen a plugin containing a specific game mode is activated the player character  gains\naccess to new weapons and abilities, and when that plugin is deactivated they lose those abilities.")]),t._v(" "),a("p",[t._v("The notes below describe:")]),t._v(" "),a("ul",[a("li",[t._v("how to add the Game Features Subsystem to an existing project (the Stack-O-Bot example) and")]),t._v(" "),a("li",[t._v("demonstrates its functionality by adding a plugin which can be dynamically enabled and disabled.")])]),t._v(" "),a("h3",{attrs:{id:"existing-plugins"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#existing-plugins"}},[t._v("#")]),t._v(" Existing Plugins")]),t._v(" "),a("p",[t._v("Unreal Engine ships with plugins which support the Game Features Subsystem.  We will be using these and adding new functionality\nto the Stack-O-Bot project using code from the Valley of the Ancient and Lyra projects.")]),t._v(" "),a("p",[t._v("The "),a("strong",[t._v("GameFeatures")]),t._v(" plugin contains:")]),t._v(" "),a("ul",[a("li",[t._v("UGameFeatureAction base class\n"),a("ul",[a("li",[t._v("UGameFeatureAction_AddCheats class")]),t._v(" "),a("li",[t._v("UGameFeatureAction_AddComponents class")]),t._v(" "),a("li",[t._v("UGameFeatureAction_DataRegistry - Specifies a list of Data Registries to load and initialize with this feature")]),t._v(" "),a("li",[t._v("UGameFeatureAction_DataRegistrySource - Specifies a list of source assets to add to Data Registries when this feature is activated")])])]),t._v(" "),a("li",[t._v("UGameFeaturesSubsystem class")]),t._v(" "),a("li",[t._v("IGameFeatureStateChangeObserver interface")])]),t._v(" "),a("p",[t._v("The "),a("strong",[t._v("ModularGameplay")]),t._v(" plugin contains:")]),t._v(" "),a("ul",[a("li",[t._v("UGameFrameworkComponentManager - A manager to handle  dynamically adding components to actors, and removing components from\nactors, as plugins are loaded and unloaded.")]),t._v(" "),a("li",[t._v("UControllerComponent - an actor component used by the AController class which receives controller events such as  ReceivedPlayer, PlayerTick")]),t._v(" "),a("li",[t._v("UGameStateComponent - an actor component used by the AGameStateBase class which receives GameState events such as HandleMatchHasStarted")])]),t._v(" "),a("hr"),t._v(" "),a("p",{attrs:{id:"top"}}),t._v(" "),a("h3",{attrs:{id:"steps"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#steps"}},[t._v("#")]),t._v(" Steps")]),t._v(" "),a("p",[t._v("These are the steps used to add the Game Features Subsystem to the StackOBot project (or any other project) and to demonstrate\nan working plugin.")]),t._v(" "),a("ol",[a("li",[a("a",{attrs:{href:"#internal_create_project"}},[t._v("Creating the Project")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#internal_modular"}},[t._v("Making the Project Modular")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#internal_plugin"}},[t._v("Creating the GameFeatureActions Plugin")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#internal_create_test"}},[t._v("Creating a Test Content")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#internal_test"}},[t._v("Testing")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#internal_workings"}},[t._v("How Does It Work?")])])]),t._v(" "),a("hr"),t._v(" "),a("p",{attrs:{id:"internal_create_project"}}),t._v(" "),a("h2",{attrs:{id:"creating-the-project"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#creating-the-project"}},[t._v("#")]),t._v(" Creating the Project")]),t._v(" "),a("p",[t._v("Download the Stack-O-Bot example project using the Epic Game Launcher.  Once it is downloaded it will\nappear in the Library|Vault section of the Epic Game Launcher like this:")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/mod_01_001.png",alt:""}})]),t._v(" "),a("p",[t._v('Create a new Stack-O-Bot project by clicking "Create Project", name the project "StackOBot".  Once\nthe Epic Game Launcher has finished creating the project exit the launcher.')]),t._v(" "),a("p",[t._v('We will be using Unreal Engine 5.1 Preview version, so in Windows Explorer find the location of the project you just created\nand right-click the StackOBot.uproject file and chose "Switch Unreal Engine version" and change the version to 5.1.  This process\nis shown here:')]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/mod_01_003.png",alt:""}})]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/mod_01_002.png",alt:""}})]),t._v(" "),a("p",[t._v("Open the project in Unreal by double-clicking the StackOBot.uproject file.")]),t._v(" "),a("p",[t._v("Depending on which Unreal versions you used, if might see a message like this:")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/mod_01_006.png",alt:""}})]),t._v(" "),a("p",[t._v("If so, update the setting as instructed by the message.")]),t._v(" "),a("p",[a("a",{attrs:{href:"#top"}},[t._v("back to top")])]),t._v(" "),a("hr"),t._v(" "),a("p",{attrs:{id:"internal_modular"}}),t._v(" "),a("h2",{attrs:{id:"making-the-project-modular"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#making-the-project-modular"}},[t._v("#")]),t._v(" Making the Project Modular")]),t._v(" "),a("p",[t._v("Both the Valley of the Ancient and the Lyra project add classes to make the project behave in a modular way, so plugins can be created which contain content\nsuch as Gameplay Abilities and Input Mapping Contexts.  These plugins can be activated to, for example, grant the player abilities which are defined in the plugin, and later deactivated to withdraw those abilities when the plugin is unloaded.")]),t._v(" "),a("p",[t._v("The Valley of the Ancient and the Lyra project classes ("),a("code",[t._v("AModularPlayerController")]),t._v(", "),a("code",[t._v("AModularCharacter")]),t._v(" etc.) used to do this are\ncontained in their own plugin called ModularGameplayActors.  These classes interact with the "),a("code",[t._v("UGameFrameworkComponentManager")]),t._v(" allowing them to\nadd and remove components from derived classes in response to plugins being enabled or disabled.")]),t._v(" "),a("h3",{attrs:{id:"gamefeatures-plugin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gamefeatures-plugin"}},[t._v("#")]),t._v(" GameFeatures Plugin")]),t._v(" "),a("p",[t._v("The Game Features plugin which ships with Unreal Engine has the classes shown on the bottom rows of the diagram below:")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/GameFeatureActionsEngine.png",alt:""}})]),t._v(" "),a("p",[t._v("These classes all extend "),a("code",[t._v("UGameFeatureAction")]),t._v(" to create actions which can be performed when\na plugin is enabled, for example UGameFeatureAction_AddComponents adds new components to specified classes.")]),t._v(" "),a("p",[t._v("When the Game Features plugin is enabled and you create a new plugin and add a new actions, the list of  actions\nyou can choose from comes from the classes derived from "),a("code",[t._v("UGameFeatureAction")]),t._v(", as shown here:")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/mod_01_004.png",alt:""}})]),t._v(" "),a("p",[t._v("In the next section we will create a new plugin which adds more actions to the list.")]),t._v(" "),a("p",[a("a",{attrs:{href:"#top"}},[t._v("back to top")])]),t._v(" "),a("hr"),t._v(" "),a("p",{attrs:{id:"internal_plugin"}}),t._v(" "),a("h2",{attrs:{id:"creating-the-gamefeatureactions-plugin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#creating-the-gamefeatureactions-plugin"}},[t._v("#")]),t._v(" Creating the GameFeatureActions Plugin")]),t._v(" "),a("p",[t._v("I have created a git repository for the GameFeatureActions plugin which\ncontains mostly files from the Valley of the Ancient project.  These\nfiles, with minor modifications, are also used in the Lyra project.  The repository contains:")]),t._v(" "),a("ul",[a("li",[t._v("classes for actions which can be done from a plugin, such as\nadding an Input Mapping Context, and")]),t._v(" "),a("li",[t._v("classes to derive from, such as AModularCharacter, which\nwork with the Game Features Subsystem when adding new components to derived classes.")])]),t._v(" "),a("p",[t._v("I have put them in a git repository purely to make them easier to access for this learning exercise. They remain (c) Epic Games.")]),t._v(" "),a("p",[t._v("This plugin contains more classes which extend "),a("code",[t._v("UGameFeatureAction")]),t._v(":")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/GameFeatureActions.png",alt:""}})]),t._v(" "),a("p",[t._v("When the GameFeatureActions plugin is enabled you can see from the below image that it adds\nmore actions to the dropdown list of action types:")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/mod_01_005.png",alt:""}})]),t._v(" "),a("p",[t._v("The process of creating the GameFeatureActions plugin is:")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("open the StackOBot project in the Unreal Editor")])]),t._v(" "),a("li",[a("p",[t._v("enable these plugins (if they are not enabled then the new GameFeatureActions plugin will not compile):")]),t._v(" "),a("ul",[a("li",[t._v('"Game Features"')]),t._v(" "),a("li",[t._v('"Gameplay Abilities"')]),t._v(" "),a("li",[t._v('"Modular Gameplay"')])])]),t._v(" "),a("li",[a("p",[t._v("add a C++ class which we will later delete, this is just to convert it from a blueprint project to a C++ project (use Tools -> New C++ Class,\nderived from None, any name will do)")])]),t._v(" "),a("li",[a("p",[t._v("exit the Unreal editor")])]),t._v(" "),a("li",[a("p",[t._v("to clone the git repository which contains the files for the GameFeatureActions plugin either:")]),t._v(" "),a("p",[t._v("(1) if the StackOBot game is not contained in a git repository, then just clone the GameFeatureActions repository into the Plugins directory like this:")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[t._v("  cd StackOBot\\Plugins\n  git clone git@github.com:JohnJFarrow/GameFeatureActions.git\n")])])]),a("p",[t._v("(2) if the StackOBot game is contained in a git repository, then add the GameFeatureActions repository as a submodule like this:")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[t._v("  cd StackOBot\\Plugins\n  git submodule add git@github.com:JohnJFarrow/GameFeatureActions.git \n")])])])]),t._v(" "),a("li",[a("p",[t._v("in Windows Explorer right-click the StackOBot.uproject and Generate Visual Studio project files")])]),t._v(" "),a("li",[a("p",[t._v("open the project in Visual Studio (by double-clicking the .sln file)")])])]),t._v(" "),a("p",[a("a",{attrs:{href:"#top"}},[t._v("back to top")])]),t._v(" "),a("hr"),t._v(" "),a("p",{attrs:{id:"internal_create_test"}}),t._v(" "),a("h2",{attrs:{id:"creating-a-test-plugin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#creating-a-test-plugin"}},[t._v("#")]),t._v(" Creating a Test Plugin")]),t._v(" "),a("p",[t._v("Here we create a new plugin which contains:")]),t._v(" "),a("ol",[a("li",[t._v("an Input Mapping Context which connects a keyboard input to an Input Action which already exists in the base StackOBot game")]),t._v(" "),a("li",[t._v("a data asset containing an action which activates the new Input Mapping Context while the plugin is active.")])]),t._v(" "),a("p",[t._v("If it is not already, open the StackOBot game in the Visual Studio and build and run it.")]),t._v(" "),a("p",[t._v('Create a new plugin by using Edit -> Plugins, click the +Add button near the top left corner, select "Game Feature (Content Only)"\nas the type of plugin, and name it "Test", as shown here:')]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/mod_01_007.png",alt:""}})]),t._v(" "),a("p",[a("em",[t._v('Do not change the path of the plugin, it needs to be in a directory under "Plugins\\GameFeatures"')])]),t._v(" "),a("p",[t._v('Press the "Create Plugin" button to create the plugin.')]),t._v(" "),a("p",[t._v("The plugin editor window should appear like this:")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/mod_01_008.png",alt:""}})]),t._v(" "),a("p",[a("em",[t._v("Press the save button now.  With the 5.1 Preview build it is easy to close the editor without saving this asset")])]),t._v(" "),a("p",[t._v("Without closing the Test data asset window, go back to the content browser and locate the new plugin, it should look something like this:")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/mod_01_009.png",alt:""}})]),t._v(" "),a("p",[t._v("Right click in the content area and select Input -> Input Mapping Context to create a new Input Mapping Context\n"),a("em",[t._v("in the plugin")]),t._v(', name it "IMC_Test".  The content browser should now look like this:')]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/mod_01_010.png",alt:""}})]),t._v(" "),a("p",[t._v('Edit IMC_Test and add an input mapping so the IA_Jump action is performed when then user presses the "U" key.  It should look\nlike this:')]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/mod_01_011.png",alt:""}})]),t._v(" "),a("p",[t._v("Save and close the input mapping.")]),t._v(" "),a("p",[t._v("Go back to the Test data asset window and")]),t._v(" "),a("ol",[a("li",[t._v("add an action which will activate the IMC_Test Input Mapping Context when the plugin\nis activated")]),t._v(" "),a("li",[t._v('change the Current State property to "Loaded"')])]),t._v(" "),a("p",[t._v("It should now look like this:")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/mod_01_012.png",alt:""}})]),t._v(" "),a("p",[t._v("Save the Test data asset.")]),t._v(" "),a("p",[a("a",{attrs:{href:"#top"}},[t._v("back to top")])]),t._v(" "),a("hr"),t._v(" "),a("p",{attrs:{id:"internal_test"}}),t._v(" "),a("h2",{attrs:{id:"testing"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#testing"}},[t._v("#")]),t._v(" Testing")]),t._v(" "),a("p",[t._v("To test if this works drag the Test data asset window to the right of the main editor window like this:")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/mod_01_013.png",alt:""}})]),t._v(" "),a("p",[t._v('You then be able to press Play in the editor and move the robot around.  The spacebar will\nmake the robot jump but the "U" key will not.')]),t._v(" "),a("p",[t._v('Alt-Tab to the Test data asset window and change the "Current State" property\nfrom whatever it is to "Active".  This will load the plugin and activate the IMC_Test Input Mapping Context.')]),t._v(" "),a("p",[t._v('Alt-Tab back to the editor window, the robot should now jump when you press the "U" key.')]),t._v(" "),a("p",[t._v('This shows that the plugin has loaded and the "Add Input Mapping" action has been executed to activate the IMC_Test Input Mapping Context.')]),t._v(" "),a("p",[t._v('Similarly if you change the "Current State" property from "Active" back to "Loaded" the "U" key will no longer make the robot jump.')]),t._v(" "),a("p",[a("a",{attrs:{href:"#top"}},[t._v("back to top")])]),t._v(" "),a("p",{attrs:{id:"internal_workings"}}),t._v(" "),a("h2",{attrs:{id:"how-does-it-work"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-does-it-work"}},[t._v("#")]),t._v(" How Does It Work?")]),t._v(" "),a("p",[t._v("Broadly speaking this is what happens when processing an action to add an Input Mapping Context from a plugin:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("UGameFeaturePluginStateMachine::UpdateStateMachine()")]),t._v(" is called by the engine when any plugin is changed to enabled")])]),t._v(" "),a("ol",[a("li",[a("p",[a("code",[t._v("UGameFeaturePluginStateMachine::UpdateStateMachine()")]),t._v(" calls "),a("code",[t._v("UGameFeaturesSubsystem::OnGameFeatureActivating()")])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("UGameFeaturesSubsystem::OnGameFeatureActivating")]),t._v(" calls "),a("code",[t._v("UGameFeatureAction_AddInputContextMapping::OnGameFeatureActivating()")])])])]),t._v(" "),a("p",[t._v("The UGameFeaturesSubsystem in the engine knows about our UGameFeatureAction_AddInputContextMapping because it\nmaintains a list of plugins:")]),t._v(" "),a("div",{staticClass:"language-cpp line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[t._v("TMap"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("FGameFeaturePluginIdentifier"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" TObjectPtr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("UGameFeaturePluginStateMachine"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),t._v(" GameFeaturePluginStateMachines"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("from which it can retrieve the actions:")]),t._v(" "),a("div",{staticClass:"language-cpp line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[t._v("UGameFeaturePluginStateMachine"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UGameFeaturesSubsystem")]),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("FindOrCreateGameFeaturePluginStateMachine")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" FString"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" PluginURL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UGameFeaturePluginStateMachine"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" ExistingStateMachine "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("FindGameFeaturePluginStateMachine")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("PluginURL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" ExistingStateMachine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\tUGameFeaturePluginStateMachine"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" NewStateMachine "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token generic-function"}},[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("NewObject")]),a("span",{pre:!0,attrs:{class:"token generic class-name"}},[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("UGameFeaturePluginStateMachine"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\tGameFeaturePluginStateMachines"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("PluginURL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" NewStateMachine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\tNewStateMachine"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("InitStateMachine")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("PluginURL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" NewStateMachine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br")])]),a("ul",[a("li",[a("code",[t._v("UGameFeatureAction_AddInputContextMapping::OnGameFeatureActivating()")]),t._v(" calls it's base class to\nloop through all world contexts and call "),a("code",[t._v("AddToWorld()")]),t._v(" on each of them:")])]),t._v(" "),a("div",{staticClass:"language-cpp line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UGameFeatureAction_WorldActionBase")]),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("OnGameFeatureActivating")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tGameInstanceStartHandle "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" FWorldDelegates"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("OnStartGameInstance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddUObject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("UGameFeatureAction_WorldActionBase"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("HandleGameInstanceStart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Add to any worlds with associated game instances that have already been initialized")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" FWorldContext"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" WorldContext "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" GEngine"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("GetWorldContexts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddToWorld")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("WorldContext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br")])]),a("ul",[a("li",[a("code",[t._v("AddToWorld()")]),t._v(" does this:")])]),t._v(" "),a("div",{staticClass:"language-cpp line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UGameFeatureAction_AddInputContextMapping")]),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddToWorld")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" FWorldContext"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" WorldContext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tUWorld"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" World "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" WorldContext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("World")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\tUGameInstance"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" GameInstance "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" WorldContext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OwningGameInstance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GameInstance "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("nullptr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("World "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("nullptr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" World"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("IsGameWorld")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UGameFrameworkComponentManager"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" ComponentMan "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" \n\t\t      UGameInstance"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token generic-function"}},[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("GetSubsystem")]),a("span",{pre:!0,attrs:{class:"token generic class-name"}},[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("UGameFrameworkComponentManager"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GameInstance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("InputMapping"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("IsNull")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\tUGameFrameworkComponentManager"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("FExtensionHandlerDelegate AddAbilitiesDelegate "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" \n\t\t\t\t\tUGameFrameworkComponentManager"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("FExtensionHandlerDelegate")]),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("CreateUObject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n\t\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("UGameFeatureAction_AddInputContextMapping"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("HandleControllerExtension"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t\t\t\tTSharedPtr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("FComponentRequestHandle"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" ExtensionRequestHandle "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" \n\t\t\t\t\tComponentMan"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddExtensionHandler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("APlayerController")]),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("StaticClass")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" AddAbilitiesDelegate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t\t\t\tExtensionRequestHandles"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ExtensionRequestHandle"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br")])]),a("p",[t._v("The key line is:")]),t._v(" "),a("div",{staticClass:"language-cpp line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[t._v("\tTSharedPtr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("FComponentRequestHandle"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" ExtensionRequestHandle "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" \n\t\tComponentMan"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddExtensionHandler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("APlayerController")]),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("StaticClass")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" AddAbilitiesDelegate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("ul",[a("li",[a("code",[t._v("AddExtensionHandler()")]),t._v(" does this:")])]),t._v(" "),a("div",{staticClass:"language-cpp line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[t._v("TSharedPtr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("FComponentRequestHandle"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UGameFrameworkComponentManager")]),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddExtensionHandler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" TSoftClassPtr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("AActor"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" ReceiverClass"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" FExtensionHandlerDelegate ExtensionHandler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tFComponentRequestReceiverClassPath "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ReceiverClassPath")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ReceiverClass"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\tFExtensionHandlerEvent"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" HandlerEvent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ReceiverClassToEventMap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("FindOrAdd")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ReceiverClassPath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// This is a fake multicast delegate using a map")]),t._v("\n\tFDelegateHandle "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("DelegateHandle")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("FDelegateHandle"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("EGenerateNewHandleType"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("GenerateNewHandle"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\tHandlerEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("DelegateHandle"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ExtensionHandler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UClass"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" ReceiverClassPtr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ReceiverClass"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\tUGameInstance"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" LocalGameInstance "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("GetGameInstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ensure")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LocalGameInstance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\tUWorld"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" LocalWorld "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" LocalGameInstance"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("GetWorld")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ensure")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LocalWorld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("TActorIterator"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("AActor"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ActorIt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LocalWorld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ReceiverClassPtr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" ActorIt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("ActorIt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ActorIt"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("IsActorInitialized")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t\t\tExtensionHandler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Execute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("ActorIt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" NAME_ExtensionAdded"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token generic-function"}},[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MakeShared")]),a("span",{pre:!0,attrs:{class:"token generic class-name"}},[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("FComponentRequestHandle"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ReceiverClass"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" DelegateHandle"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br"),a("span",{staticClass:"line-number"},[t._v("31")]),a("br")])]),a("p",[t._v("The key line is:")]),t._v(" "),a("div",{staticClass:"language-cpp line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[t._v("TActorIterator"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("AActor"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ActorIt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LocalWorld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ReceiverClassPtr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" ActorIt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("ActorIt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("which finds all the actors in the world of the required class.  In the case of adding an Input Mapping Context\nit finds all the actors of the "),a("code",[t._v("PlayerController")]),t._v(" class and invokes the ExtensionHandler on each actor:")]),t._v(" "),a("div",{staticClass:"language-cpp line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[t._v("ExtensionHandler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Execute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("ActorIt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" NAME_ExtensionAdded"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("The invocation of the extension handler calls "),a("code",[t._v("UGameFeatureAction_AddInputContextMapping::HandleControllerExtension()")]),t._v("\nwhich calls "),a("code",[t._v("InputSystem->AddMappingContext()")]),t._v(" to add the Input Mapping Context")]),t._v(" "),a("h2",{attrs:{id:"reference"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#reference"}},[t._v("#")]),t._v(" Reference")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://docs.unrealengine.com/5.0/en-US/gameplay-tags-in-unreal-engine/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Epic Gameplay Tags"),a("OutboundLink")],1),a("br"),t._v(" "),a("a",{attrs:{href:"https://nerivec.github.io/old-ue4-wiki/pages/gameplayabilities-and-you.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Old Wiki Article: Gameplay Abilities and You"),a("OutboundLink")],1),a("br"),t._v(" "),a("a",{attrs:{href:"https://forums.unrealengine.com/t/comprehensive-gameplayabilities-analysis-series/91086",target:"_blank",rel:"noopener noreferrer"}},[t._v("Unreal Forums: Comprehensive Gameplay Abilities Analysis"),a("OutboundLink")],1),a("br"),t._v(" "),a("a",{attrs:{href:"https://forums.unrealengine.com/t/gameplay-abilities-and-weapon-firing/130633/12",target:"_blank",rel:"noopener noreferrer"}},[t._v("Unreal Forums: Gameplay Abilities and Weapon Firing"),a("OutboundLink")],1),a("br"),t._v(" "),a("a",{attrs:{href:"https://github.com/tranek/GASDocumentation#concepts-at",target:"_blank",rel:"noopener noreferrer"}},[t._v("Tranek GAS Documentation"),a("OutboundLink")],1),a("br"),t._v(" "),a("a",{attrs:{href:"https://forums.unrealengine.com/docs?topic=265041",target:"_blank",rel:"noopener noreferrer"}},[t._v("Unreal Forums: A holistic look at replicated movement"),a("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=s.exports}}]);